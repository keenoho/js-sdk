{"version":3,"file":"keenoho.umd.external.min.js","sources":["../../src/constant/index.js","../../src/util/index.js","../../src/config/index.js","../../src/util/request.js","../../src/signature/index.js","../../src/user/index.js","../../src/util/eventEmitter.js","../../src/sdk.js","../../index.js"],"sourcesContent":["export const PLATFORM_NODE = 'node';\nexport const PLATFORM_BROWSER = 'browser';\nexport const apiMap = {\n  v1: {\n    SignatureSign: '/v1/signature/sign',\n    SignatureCheck: '/v1/signature/check',\n    SignatureRefresh: '/v1/signature/refresh',\n    SignatureData: '/v1/signature/data',\n    UserLogin: '/v1/user/login',\n    UserInfo: '/v1/user/info',\n  },\n};\n","import { PLATFORM_NODE, PLATFORM_BROWSER } from '../constant';\n\nexport function judgePlatform() {\n  return typeof document === 'undefined' ? PLATFORM_NODE : PLATFORM_BROWSER;\n}\n","import { judgePlatform } from '../util';\nimport { PLATFORM_BROWSER } from '../constant';\n\nconst storeConfig = {\n  platform: judgePlatform(),\n  app: undefined,\n  signature: undefined,\n  publicKey: undefined,\n  env: 'production',\n  mode: 'production',\n  apiHost: undefined,\n  ttl: 3200,\n};\n\nexport function loadBrowserConfig() {\n  const app = storeConfig.app || window.APP || undefined;\n  const env = storeConfig.env || window.ENV || undefined;\n  const mode = storeConfig.mode || window.MODE || undefined;\n  const publicKey = storeConfig.publicKey || window.APP_PUBLIC_KEY || undefined;\n  const ttl = storeConfig.ttl || window.SIGNATURE_TTL || 3200;\n  const apiHost =\n    storeConfig.apiHost ||\n    window.SYSTEMCE_HOST ||\n    (location.protocol.indexOf('https') > -1 ? 'http://api.keenoho.space' : 'https://api.keenoho.space');\n  setConfig({\n    app,\n    env,\n    mode,\n    publicKey,\n    ttl,\n    apiHost,\n  });\n}\n\nexport function loadNodeConfig() {}\n\nexport function loadConfig() {\n  if (judgePlatform() === PLATFORM_BROWSER) {\n    loadBrowserConfig();\n  } else {\n    loadNodeConfig();\n  }\n}\n\nexport function getConfig(key) {\n  if (key in storeConfig) {\n    return storeConfig[key];\n  }\n  return storeConfig;\n}\n\nexport function setConfig(key, value) {\n  if (arguments.length == 1 && typeof arguments[0] === 'object') {\n    for (let k in arguments[0]) {\n      storeConfig[k] = arguments[0][k] || storeConfig[k];\n    }\n  } else if (arguments.length == 2) {\n    storeConfig[key] = value || storeConfig[key];\n  }\n}\n\nexport function checkConfig(checkSignature = false) {\n  if (!storeConfig.app || !storeConfig.publicKey) {\n    throw new Error('the app or publicKey is not set in config, please use setConfig to set the values');\n  }\n  if (checkSignature && !storeConfig.signature) {\n    throw new Error('the signature has not sign, please use signature.sign to sign');\n  }\n}\n","import axios from 'axios';\nimport { getConfig } from '../config';\nimport { computeSession } from '../signature';\n\nconst defaultAxiosOptions = {\n  url: '',\n  baseURL: '',\n  params: undefined,\n  data: undefined,\n  header: undefined,\n  method: 'GET',\n  cancelToken: undefined,\n};\nconst defaultRequestOption = {\n  needApp: true,\n  needSignature: true,\n  needSessionId: true,\n  targetCode: 0,\n  takeInnerData: false,\n};\n\nconst Request = axios.create();\nRequest.interceptors.request.use(\n  function (config) {\n    const { requestOptions = defaultRequestOption } = config;\n    const { app, signature, apiHost } = getConfig();\n    if (!config.baseURL && apiHost) {\n      config.baseURL = apiHost;\n    }\n    if (!config.headers) {\n      config.headers = {};\n    }\n    if (requestOptions.needApp) {\n      config.headers['x-app'] = app;\n    }\n    if (requestOptions.needSignature) {\n      config.headers['x-signature'] = signature;\n    }\n    if (requestOptions.needSessionId) {\n      const u = new URL(config.url.indexOf('http') > -1 ? config.url : config.baseURL + config.url);\n      const pathname = u.pathname;\n      config.headers['x-session-id'] = computeSession(app, pathname, signature);\n    }\n\n    return config;\n  },\n  function (error) {\n    return Promise.reject(error);\n  }\n);\nRequest.interceptors.response.use(\n  function (response) {\n    const { requestOptions = defaultRequestOption } = response.config;\n    const data = response.data;\n    if (typeof data === 'object' && 'code' in data && 'msg' in data) {\n      const code = data.code;\n      if (code !== requestOptions.targetCode) {\n        throw data;\n      }\n    }\n\n    let finalData = data;\n    if (requestOptions.takeInnerData && typeof data === 'object' && 'data' in data) {\n      finalData = data.data;\n    }\n    return finalData;\n  },\n  function (error) {\n    if (error instanceof axios.AxiosError) {\n      const { response } = error;\n      if (!response) {\n        return Promise.reject(error);\n      }\n\n      const { requestOptions = defaultRequestOption } = response.config;\n      const data = response.data;\n      if (typeof data === 'object' && 'code' in data && 'msg' in data) {\n        const code = data.code;\n        if (code !== requestOptions.targetCode) {\n          return Promise.reject(data);\n        }\n      }\n\n      let finalData = data;\n      if (requestOptions.takeInnerData && typeof data === 'object' && 'data' in data) {\n        finalData = data.data;\n      }\n      return Promise.reject(finalData);\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport function request(axiosOptions = defaultAxiosOptions, requestOptions = defaultRequestOption) {\n  axiosOptions = Object.assign({}, defaultAxiosOptions, axiosOptions);\n  requestOptions = Object.assign({}, defaultRequestOption, requestOptions);\n  return Request({\n    ...axiosOptions,\n    requestOptions,\n  });\n}\n\nexport function get(axiosOptions = defaultAxiosOptions, requestOptions = defaultRequestOption) {\n  axiosOptions.method = 'GET';\n  return request(axiosOptions, requestOptions);\n}\n\nexport function post(axiosOptions = defaultAxiosOptions, requestOptions = defaultRequestOption) {\n  axiosOptions.method = 'POST';\n  return request(axiosOptions, requestOptions);\n}\n","import CryptoJS from 'crypto-js';\nimport { v4 as uuid } from 'uuid';\nimport { getConfig, checkConfig, setConfig } from '../config';\nimport { get } from '../util/request';\nimport { apiMap } from '../constant';\n\nexport function computeSign(app, ts, ttl, uid, publicKey) {\n  const str = `${app}${ts}${ttl}${uid}`.split('').sort().join('');\n  return CryptoJS.HmacSHA1(str, publicKey);\n}\n\nexport function computeSession(app, path, sign) {\n  const str = `${app}:${path}`.split('').sort().join('');\n  return CryptoJS.HmacSHA1(str, sign);\n}\n\nexport async function sign() {\n  checkConfig();\n  const { app, publicKey, ttl } = getConfig();\n  const ts = Date.now();\n  const uid = uuid();\n  const sig = computeSign(app, ts, ttl, uid, publicKey);\n  const res = await get(\n    {\n      url: apiMap.v1.SignatureSign,\n      params: {\n        app,\n        ts,\n        ttl,\n        sig,\n        randomId: uid,\n      },\n    },\n    {\n      needApp: false,\n      needSignature: false,\n      needSessionId: false,\n    }\n  );\n  if (res && res.code === 0) {\n    setConfig('signature', res.data);\n  }\n  return res;\n}\n\nexport async function check() {\n  checkConfig();\n  return await get({\n    url: apiMap.v1.SignatureCheck,\n    params: {},\n  });\n}\n\nexport async function refresh() {\n  checkConfig();\n  return await get({\n    url: apiMap.v1.SignatureRefresh,\n    params: {},\n  });\n}\n\nexport async function data() {\n  checkConfig();\n  return await get({\n    url: apiMap.v1.SignatureData,\n    params: {},\n  });\n}\n","import { getConfig, checkConfig, setConfig } from '../config';\nimport { get, post } from '../util/request';\nimport { apiMap } from '../constant';\n\nexport function login(options) {\n  checkConfig();\n  const { app } = getConfig();\n  return post({\n    url: apiMap.v1.UserLogin,\n    data: {\n      app,\n      ...options,\n    },\n  });\n}\n\nexport function info(options) {\n  checkConfig();\n  const { app } = getConfig();\n  return get({\n    url: apiMap.v1.UserInfo,\n    params: {\n      app,\n      ...options,\n    },\n  });\n}\n","export default class EventEmitter {\n  callbacks = {};\n  addEventListener(type, callback) {\n    this.callbacks[type] = callback;\n  }\n  removeEventListener(type) {\n    delete this.callbacks[type];\n  }\n  emit(type, ...args) {\n    if (typeof this.callbacks[type] === 'function') {\n      this.callbacks[type](...args);\n    }\n  }\n}\n","import { getConfig, loadConfig, setConfig } from './config';\nimport Logger from './util/logger';\nimport EventEmitter from './util/eventEmitter';\nimport { sign, check, refresh, data } from './signature';\nimport { login, info } from './user';\nimport { request } from './util/request';\n\nconst storeKeyMap = {\n  signature: 'keenoho_signature',\n  app: 'keenoho_app',\n  publicKey: 'keenoho_publicKey',\n};\n\nexport default class SDK extends (Logger, EventEmitter) {\n  config = {};\n  user = {};\n\n  constructor() {\n    super();\n    this.initConfig();\n    this.initSignature();\n  }\n\n  config(valueMap) {\n    setConfig(valueMap);\n    this.config = Object.assign(this.config, getConfig());\n  }\n\n  ready(callback) {\n    this.addEventListener('ready', callback);\n  }\n\n  error(callback) {\n    this.addEventListener('error', callback);\n  }\n\n  initConfig() {\n    loadConfig();\n    const storeApp = localStorage.getItem(storeKeyMap.app);\n    const storePublicKey = localStorage.getItem(storeKeyMap.publicKey);\n    this.config = Object.assign({}, getConfig());\n    if (storeApp) {\n      setConfig('app', +storeApp || undefined);\n      this.config.app = +storeApp || undefined;\n    }\n    if (storePublicKey) {\n      setConfig('publicKey', storePublicKey);\n      this.config.publicKey = storePublicKey;\n    }\n  }\n\n  async initSignature() {\n    const storeSignature = localStorage.getItem(storeKeyMap.signature);\n    if (storeSignature) {\n      setConfig('signature', storeSignature);\n      const checkRes = await check()\n        .then(() => {\n          return true;\n        })\n        .catch((err) => {\n          setConfig('signature', undefined);\n          localStorage.removeItem(storeKeyMap.signature);\n          this.emit('error', err);\n          return false;\n        });\n\n      if (checkRes) {\n        const refreshRes = await refresh()\n          .then(() => {\n            return true;\n          })\n          .catch((err) => {\n            setConfig('signature', undefined);\n            localStorage.removeItem(storeKeyMap.signature);\n            this.emit('error', err);\n            return false;\n          });\n        if (refreshRes) {\n          this.emit('ready');\n          return;\n        }\n      }\n    }\n    await sign()\n      .then((res) => {\n        if (res && res.code == 0 && res.data) {\n          return res.data;\n        }\n        throw res;\n      })\n      .then((res) => {\n        localStorage.setItem(storeKeyMap.signature, res);\n        this.emit('ready');\n      })\n      .catch((err) => {\n        setConfig('signature', undefined);\n        localStorage.removeItem(storeKeyMap.signature);\n        this.emit('error', err);\n      });\n  }\n\n  addPlugin(pluginFunc) {\n    pluginFunc.call(this);\n  }\n\n  sendRequest(axiosOptions, requestOptions) {\n    return request(axiosOptions, requestOptions);\n  }\n\n  login(options) {\n    return login(options).then((res) => {\n      if (res && res.code === 0) {\n        this.user = res.data;\n      }\n      return res;\n    });\n  }\n\n  info(options) {\n    return info(options);\n  }\n\n  data() {\n    return data();\n  }\n}\n","import * as config from './src/config';\nimport * as signature from './src/signature';\nimport * as user from './src/user';\nimport * as request from './src/util/request';\nimport SDK from './src/sdk';\n\nexport default {\n  config,\n  signature,\n  user,\n  request,\n  SDK,\n};\n"],"names":["PLATFORM_NODE","PLATFORM_BROWSER","apiMap","v1","SignatureSign","SignatureCheck","SignatureRefresh","SignatureData","UserLogin","UserInfo","judgePlatform","document","storeConfig","platform","app","undefined","signature","publicKey","env","mode","apiHost","ttl","loadBrowserConfig","setConfig","window","APP","ENV","MODE","APP_PUBLIC_KEY","SIGNATURE_TTL","SYSTEMCE_HOST","location","protocol","indexOf","loadConfig","getConfig","key","value","arguments","length","_typeof","k","checkConfig","checkSignature","Error","defaultAxiosOptions","url","baseURL","params","data","header","method","cancelToken","defaultRequestOption","needApp","needSignature","needSessionId","targetCode","takeInnerData","Request","axios","create","request","axiosOptions","requestOptions","Object","assign","_objectSpread","get","post","interceptors","use","config","_config$requestOption","_getConfig","headers","pathname","URL","computeSession","error","Promise","reject","response","_response$config$requ","code","finalData","AxiosError","_response$config$requ2","computeSign","ts","uid","str","concat","split","sort","join","CryptoJS","HmacSHA1","path","sign","_sign","apply","this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","sig","res","wrap","_context","prev","next","Date","now","uuid","v4","randomId","sent","abrupt","stop","check","_check","_callee2","_context2","refresh","_refresh","_callee3","_context3","_data","_callee4","_context4","login","options","info","EventEmitter","_classCallCheck","_defineProperty","_createClass","type","callback","callbacks","_this$callbacks","_len","args","Array","_key","storeKeyMap","SDK","_ref","_inherits","_initSignature","_super","_createSuper","_this","_assertThisInitialized","call","initConfig","initSignature","valueMap","addEventListener","storeApp","localStorage","getItem","storePublicKey","storeSignature","_this2","then","err","removeItem","emit","setItem","pluginFunc","_this3","user","Logger"],"mappings":"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"}