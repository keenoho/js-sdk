{"version":3,"file":"keenoho.umd.external.min.js","sources":["../../src/config/index.js","../../src/util/index.js","../../src/constant/index.js","../../src/util/request.js","../../src/signature/index.js","../../src/util/eventEmitter.js","../../src/sdk.js","../../index.js"],"sourcesContent":["import { judgePlatform } from '../util';\nimport { PLATFORM_BROWSER } from '../constant';\n\nconst storeConfig = {\n  platform: judgePlatform(),\n  app: undefined,\n  signature: undefined,\n  publicKey: undefined,\n  env: 'production',\n  mode: 'production',\n  apiHost: undefined,\n  ttl: 3200,\n};\n\nconst envConfigKeyMap = {};\n\nexport function loadBrowserConfig() {}\n\nexport function loadNodeConfig() {}\n\nexport function loadConfig() {\n  if (judgePlatform() === PLATFORM_BROWSER) {\n    loadBrowserConfig();\n  } else {\n    loadNodeConfig();\n  }\n}\n\nexport function getConfig(key) {\n  if (key in storeConfig) {\n    return storeConfig[key];\n  }\n  return storeConfig;\n}\n\nexport function setConfig(key, value) {\n  if (arguments.length == 1 && typeof arguments[0] === 'object') {\n    for (let k in arguments[0]) {\n      storeConfig[k] = arguments[0][k];\n    }\n  } else if (arguments.length == 2) {\n    storeConfig[key] = value;\n  }\n}\n\nexport function checkConfig(checkSignature = false) {\n  if (!storeConfig.app || !storeConfig.publicKey) {\n    throw new Error('the app or publicKey is not set in config, please use setConfig to set the values');\n  }\n  if (checkSignature && !storeConfig.signature) {\n    throw new Error('the signature has not sign, please use signature.sign to sign');\n  }\n}\n","import { PLATFORM_NODE, PLATFORM_BROWSER } from '../constant';\n\nexport function judgePlatform() {\n  return typeof document === 'undefined' ? PLATFORM_NODE : PLATFORM_BROWSER;\n}\n","export const PLATFORM_NODE = 'node'\nexport const PLATFORM_BROWSER = 'browser'\n","import axios from 'axios';\nimport { getConfig } from '../config';\nimport { computeSession } from '../signature';\n\nconst defaultAxiosOptions = {\n  url: '',\n  baseURL: '',\n  params: undefined,\n  data: undefined,\n  header: undefined,\n  method: 'GET',\n  cancelToken: undefined,\n};\nconst defaultRequestOption = {\n  needApp: true,\n  needSignature: true,\n  needSessionId: true,\n  targetCode: 0,\n  takeInnerData: false,\n};\n\nconst Request = axios.create();\nRequest.interceptors.request.use(\n  function (config) {\n    const { requestOptions = defaultRequestOption } = config;\n    const { app, signature, apiHost } = getConfig();\n    if (!config.baseURL && apiHost) {\n      config.baseURL = apiHost;\n    }\n    if (!config.headers) {\n      config.headers = {};\n    }\n    if (requestOptions.needApp) {\n      config.headers['x-app'] = app;\n    }\n    if (requestOptions.needSignature) {\n      config.headers['x-signature'] = signature;\n    }\n    if (requestOptions.needSessionId) {\n      const u = new URL(config.url.indexOf('http') > -1 ? config.url : config.baseURL + config.url);\n      const pathname = u.pathname;\n      config.headers['x-session-id'] = computeSession(app, pathname, signature);\n    }\n\n    return config;\n  },\n  function (error) {\n    return Promise.reject(error);\n  }\n);\nRequest.interceptors.response.use(\n  function (response) {\n    const { requestOptions = defaultRequestOption } = response.config;\n    const data = response.data;\n    if (typeof data === 'object' && 'code' in data && 'msg' in data) {\n      const code = data.code;\n      if (code !== requestOptions.targetCode) {\n        throw data;\n      }\n    }\n\n    let finalData = data;\n    if (requestOptions.takeInnerData && typeof data === 'object' && 'data' in data) {\n      finalData = data.data;\n    }\n    return finalData;\n  },\n  function (error) {\n    if (error instanceof axios.AxiosError) {\n      const { response } = error;\n      if (!response) {\n        return Promise.reject(error);\n      }\n\n      const { requestOptions = defaultRequestOption } = response.config;\n      const data = response.data;\n      if (typeof data === 'object' && 'code' in data && 'msg' in data) {\n        const code = data.code;\n        if (code !== requestOptions.targetCode) {\n          return Promise.reject(data);\n        }\n      }\n\n      let finalData = data;\n      if (requestOptions.takeInnerData && typeof data === 'object' && 'data' in data) {\n        finalData = data.data;\n      }\n      return Promise.reject(finalData);\n    }\n    return Promise.reject(error);\n  }\n);\n\nexport function request(axiosOptions = defaultAxiosOptions, requestOptions = defaultRequestOption) {\n  axiosOptions = Object.assign({}, defaultAxiosOptions, axiosOptions);\n  requestOptions = Object.assign({}, defaultRequestOption, requestOptions);\n  return Request({\n    ...axiosOptions,\n    requestOptions,\n  });\n}\n\nexport function get(axiosOptions = defaultAxiosOptions, requestOptions = defaultRequestOption) {\n  axiosOptions.method = 'GET';\n  return request(axiosOptions, requestOptions);\n}\n\nexport function post(axiosOptions = defaultAxiosOptions, requestOptions = defaultRequestOption) {\n  axiosOptions.method = 'POST';\n  return request(axiosOptions, requestOptions);\n}\n","import CryptoJS from 'crypto-js';\nimport { v4 as uuid } from 'uuid';\nimport { getConfig, checkConfig, setConfig } from '../config';\nimport { get } from '../util/request';\n\nconst apiMap = {\n  v1: {\n    SignatureSign: '/v1/signature/sign',\n    SignatureCheck: '/v1/signature/check',\n    SignatureRefresh: '/v1/signature/refresh',\n  },\n};\n\nexport function computeSign(app, ts, ttl, uid, publicKey) {\n  const str = `${app}${ts}${ttl}${uid}`.split('').sort().join('');\n  return CryptoJS.HmacSHA1(str, publicKey);\n}\n\nexport function computeSession(app, path, sign) {\n  const str = `${app}:${path}`.split('').sort().join('');\n  return CryptoJS.HmacSHA1(str, sign);\n}\n\nexport async function sign() {\n  checkConfig();\n  const { app, publicKey, ttl } = getConfig();\n  const ts = Date.now();\n  const uid = uuid();\n  const sig = computeSign(app, ts, ttl, uid, publicKey);\n  const res = await get(\n    {\n      url: apiMap.v1.SignatureSign,\n      params: {\n        app,\n        ts,\n        ttl,\n        sig,\n        randomId: uid,\n      },\n    },\n    {\n      needApp: false,\n      needSignature: false,\n      needSessionId: false,\n    }\n  );\n  if (res && res.code === 0) {\n    setConfig('signature', res.data);\n  }\n  return res;\n}\n\nexport async function check() {\n  checkConfig();\n  return await get({\n    url: apiMap.v1.SignatureCheck,\n    params: {},\n  });\n}\n\nexport async function refresh() {\n  checkConfig();\n  return await get({\n    url: apiMap.v1.SignatureRefresh,\n    params: {},\n  });\n}\n","export default class EventEmitter {\n  callbacks = {};\n  addEventListener(type, callback) {\n    this.callbacks[type] = callback;\n  }\n  removeEventListener(type) {\n    delete this.callbacks[type];\n  }\n  emit(type, ...args) {\n    if (typeof this.callbacks[type] === 'function') {\n      this.callbacks[type](...args);\n    }\n  }\n}\n","import { getConfig, loadConfig, setConfig } from './config';\nimport Logger from './util/logger';\nimport EventEmitter from './util/eventEmitter';\nimport { sign, check, refresh } from './signature';\nimport { request } from './util/request';\n\nconst storeKeyMap = {\n  signature: 'keenoho_signature',\n  app: 'keenoho_app',\n  publicKey: 'keenoho_publicKey',\n};\n\nexport default class SDK extends (Logger, EventEmitter) {\n  config = {};\n  constructor() {\n    super();\n    this.initConfig();\n    this.initSignature();\n  }\n\n  config(valueMap) {\n    setConfig(valueMap);\n    this.config = Object.assign(this.config, getConfig());\n  }\n\n  ready(callback) {\n    this.addEventListener('ready', callback);\n  }\n\n  error(callback) {\n    this.addEventListener('error', callback);\n  }\n\n  initConfig() {\n    loadConfig();\n    const storeApp = localStorage.getItem(storeKeyMap.app);\n    const storePublicKey = localStorage.getItem(storeKeyMap.publicKey);\n    this.config = Object.assign({}, getConfig());\n    if (storeApp) {\n      setConfig('app', +storeApp || undefined);\n      this.config.app = +storeApp || undefined;\n    }\n    if (storePublicKey) {\n      setConfig('publicKey', storePublicKey);\n      this.config.publicKey = storePublicKey;\n    }\n  }\n\n  async initSignature() {\n    const storeSignature = localStorage.getItem(storeKeyMap.signature);\n    if (storeSignature) {\n      setConfig('signature', storeSignature);\n      const checkRes = await check()\n        .then(() => {\n          return true;\n        })\n        .catch(() => {\n          setConfig('signature', undefined);\n          return false;\n        });\n\n      if (checkRes) {\n        const refreshRes = await refresh()\n          .then(() => {\n            return true;\n          })\n          .catch(() => {\n            setConfig('signature', undefined);\n            return false;\n          });\n        if (refreshRes) {\n          return;\n        }\n      }\n    }\n    await sign()\n      .then((res) => {\n        if (res && res.code == 0 && res.data) {\n          return res.data;\n        }\n        throw res;\n      })\n      .then((res) => {\n        localStorage.setItem(storeKeyMap.signature, res);\n      })\n      .catch((err) => {\n        setConfig('signature', undefined);\n        return err;\n      });\n  }\n\n  addPlugin(pluginFunc) {\n    pluginFunc.call(this);\n  }\n\n  sendRequest(axiosOptions, requestOptions) {\n    return request(axiosOptions, requestOptions);\n  }\n}\n","import * as config from './src/config';\nimport * as signature from './src/signature';\nimport * as request from './src/util/request';\nimport SDK from './src/sdk';\n\nexport default {\n  config,\n  signature,\n  request,\n  SDK,\n};\n"],"names":["storeConfig","platform","document","app","undefined","signature","publicKey","env","mode","apiHost","ttl","getConfig","key","setConfig","value","arguments","length","_typeof","k","checkConfig","checkSignature","Error","defaultAxiosOptions","url","baseURL","params","data","header","method","cancelToken","defaultRequestOption","needApp","needSignature","needSessionId","targetCode","takeInnerData","Request","axios","create","request","axiosOptions","requestOptions","Object","assign","_objectSpread","get","interceptors","use","config","_config$requestOption","_getConfig","headers","pathname","URL","indexOf","computeSession","error","Promise","reject","response","_response$config$requ","code","finalData","AxiosError","_response$config$requ2","apiMap","v1","SignatureSign","SignatureCheck","SignatureRefresh","computeSign","ts","uid","str","concat","split","sort","join","CryptoJS","HmacSHA1","path","sign","_sign","apply","this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","sig","res","wrap","_context","prev","next","Date","now","uuid","v4","randomId","sent","abrupt","stop","check","_check","_callee2","_context2","refresh","_refresh","_callee3","_context3","EventEmitter","_classCallCheck","_defineProperty","_createClass","type","callback","callbacks","_this$callbacks","_len","args","Array","_key","storeKeyMap","SDK","_ref","_inherits","_initSignature","_super","_createSuper","_this","_assertThisInitialized","call","initConfig","initSignature","valueMap","addEventListener","storeApp","localStorage","getItem","storePublicKey","storeSignature","then","setItem","err","pluginFunc","Logger"],"mappings":"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"}